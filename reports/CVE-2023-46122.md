## CVE-2023-46122

https://github.com/advisories/GHSA-h9mw-grgx-2fhf

Уязвимость заключается в том, что в архиве ZIP злоумышленник может использовать последовательности для выхода за
пределы целевой директории (например, ../) и, таким образом, перезаписывать произвольные файлы в системе

## POC

[SbtAttack.java](../src/main/java/org/example/SbtAttack.java)

После выполнения файл sbt-bad-file.txt оказывается на одном уровне с sbt-unzipped, демонстрируя успешное выполнение
атаки directory traversal

## Sink

java.io.FileOutputStream.write

Публичный метод, в который нужно передавать архив: sbt.io.IO.unzip

## Fix

https://github.com/sbt/io/pull/360/commits/f928cdd8aebc5a2b85c326cc267e698229e0b7b2

Исправление в методе extract, который вызывает из unzip для распаковки архива. Цепочка вызовов: unzip -> unzipStream ->
extract

Добавили валидацию пути файла, куда распаковываем:

```scala
def validateExtractPath(name: String, target: NioPath): Unit = {
  if (!target.normalize().toString.startsWith(canonicalDirPath)) {
    throw new RuntimeException(s"Entry ($name) is outside of the target directory")
  }
  // ...
}
```

```scala
val target = toDirectory.resolve(name)
validateExtractPath(name, target) // <- проверили, что место распаковки внутри нашей директории, то есть zip-slip теперь невозможен
```
