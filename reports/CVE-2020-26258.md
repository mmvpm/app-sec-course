## CVE-2020-26258

https://github.com/advisories/GHSA-4cch-wxpw-8p28

Уязвимость заключается в том, что с помощью XStream-обработки можно заставить сервер отправлять запросы к внутренним
ресурсам, которые не должны быть доступны извне. Таким образом можно получить доступ к конфиденциальной информации или
взаимодействовать с внутренними системами, что может привести к утечке данных или другим проблемам безопасности.

## POC

[XStreamAttack.java](../src/main/java/org/example/XStreamAttack.java)

## Sink

java.lang.invoke.MethodHandle#invokeExact

Публичный метод, который нужно вызывать: com.thoughtworks.xstream.XStream.fromXML(java.lang.String)

Далее исполнение придет к com.thoughtworks.xstream.mapper.DefaultMapper.realClass, который загрузит класс
jdk.nashorn.internal.objects.NativeString, который используется для запуска скриптов внутри JVM

## Fix

Коммит, где описывается уязвимость https://github.com/x-stream/xstream/commit/ecc111cf22039eb9edcaec68dec05506b67e9382

Коммит, который исправляет уязвимость не смог найти, но зато в самом репорте есть способы избежать уязвимости даже с
ранними версиями: https://github.com/advisories/GHSA-4cch-wxpw-8p28

Исправления там сводятся к тому, чтобы запретить XML парсеру обрабатывать определенные классы:

```
xstream.denyTypes(new String[] {"jdk.nashorn.internal.objects.NativeString"});
xstream.denyTypesByRegExp(new String[] {".*\\.ReadAllStream\\$FileStream"});
```
